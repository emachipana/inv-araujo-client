<section class="container">
  <img 
    src="/logo.png"
    class="image"
  />
  <form [formGroup]="form">
    <custom-input
      formControlName="search"
      id="search"
      placeholder="Busca un producto..."
      icon="search"
    />
  </form>
  <div class="section">
    <section class="section cursor-pointer" style="gap: 0.3rem" (mouseenter)="profile.toggle($event)">
      <p class="text" [ngClass]="{'active': isProfOpen}">
        Hola,
        <br /> 
        <span style="font-weight: 700;">
          @if (_authService.isLoggedIn()) {
            {{userFirstName()}}
          }@else {
            Iniciar sesión
          }
        </span>
      </p>
      <mat-icon class="icon" [ngClass]="{'active': isProfOpen}">person</mat-icon>
    </section>
    <hr class="vertical" />
    <div style="position: relative;">
      <mat-icon 
        class="icon" 
        [ngClass]="{'active': isCartOpen}"
        (mouseenter)="cart.toggle($event)"
      >
        shopping_cart
      </mat-icon>
      <span 
        class="cart-items"
        [ngClass]="{'cart-items-active': isCartOpen}"
      >
        {{_cartService.items().length}}
      </span>
    </div>
  </div>
</section>
<p-menu #profile [popup]="true" (onShow)="isProfOpen = true" (onHide)="isProfOpen = false">
  <ng-template pTemplate="start">
    <div class="flex-column">
      @if(_authService.isLoggedIn()) {
        <menu-item
          (onClick)="router.navigate(['/perfil'])"
        >
          Mi cuenta
        </menu-item>
        <menu-item 
        >
          Mis compras
        </menu-item>
        <menu-item
          (onClick)="_authService.logout()"
        >
          Cerrar sesión
        </menu-item>
      }@else {
        <menu-item 
          (onClick)="handleProf('login')"
        >
          Iniciar sesión
        </menu-item>
        <menu-item 
          (onClick)="handleProf('register')"
        >
          Registrarme
        </menu-item>
      }
    </div>
  </ng-template>
</p-menu>
<p-menu #cart [popup]="true" (onShow)="isCartOpen = true" (onHide)="isCartOpen = false">
  <ng-template pTemplate="start">
    mi carritooo
  </ng-template>
</p-menu>
